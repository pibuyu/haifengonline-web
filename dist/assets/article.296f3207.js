import{af as $,r as v,aU as j,k as q,S as u,H as m,d as z,M as H,E as J,J as N,a2 as V,A as W,a6 as G,c as h,b as _,i as f,u as a,F as O,e as P,v as A,g as n,C as Q,D as U,a as g,q as K,t as X,aQ as Y,aW as Z,l as ee}from"./index.0228ac47.js";import"./el-infinite-scroll.3c533531.js";/* empty css                 *//* empty css                  *//* empty css                        */import{_ as te}from"./pageHeader.3132b316.js";import{j as oe,k as se}from"./contribution.36ea1e3c.js";import{a as ae}from"./creation.6bf1bcd7.js";import{v as F}from"./focus.de63bc5a.js";import{y as S}from"./vue-ellipsis-3.es.74e51318.js";import"./index.f22c08f3.js";const ie=()=>{const e=$().globalData.loading,i=ae(),s=j(),t=q(),o=v([]),c=v({page:1,size:8}),B=v(!0),p=v(!1),r=v(!1);return{articleList:o,isLoading:B,route:s,router:t,pageInfo:c,loading:e,isLoadMore:p,isTheEnd:r,editArticleStore:i}},ne=(e,i)=>{i.push({name:"ArticleShow",params:{id:e.id}})},le=async(e,i)=>{try{u.fire({heightAuto:!1,title:"\u786E\u8BA4\u5220\u9664\u8BE5\u6587\u7AE0\u561B",icon:"warning",confirmButtonColor:m.colorButtonTheme,showCancelButton:!0,confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",reverseButtons:!0}).then(async s=>{if(s.isConfirmed)try{await se({id:i}),u.fire({title:"\u5220\u9664\u6210\u529F",confirmButtonColor:m.colorButtonTheme,heightAuto:!1,icon:"success"}),e.value=e.value.filter(t=>(t.id==i&&(t.is_delete=!0),t)),setTimeout(()=>{e.value=e.value.filter(t=>t.id!=i)},400)}catch(t){console.log(t),u.fire({title:"\u5220\u9664\u5931\u8D25",heightAuto:!1,confirmButtonColor:m.colorButtonTheme,icon:"error"})}else s.dismiss===u.DismissReason.cancel&&console.log("\u53D6\u6D88")})}catch{u.fire({title:"\u5220\u9664\u5931\u8D25",heightAuto:!1,confirmButtonColor:m.colorButtonTheme,icon:"error"})}},ce=async(e,i,s,t)=>{try{s.setEditArticleData({articleID:e.id,title:e.title,cover:e.cover,cover_url:e.cover_url,cover_upload_type:e.cover_upload_type,content:e.content,is_comments:e.is_comments,label:e.label,classification_id:e.classification_id}),t.push({name:"Contribute",query:{type:"editArticle"}})}catch{u.fire({title:"\u7F16\u8F91\u5931\u8D25",heightAuto:!1,confirmButtonColor:m.colorButtonTheme,icon:"error"})}},k=async(e,i,s,t)=>{try{const o=await oe({page_info:s.value});if(s.value.page++,!o.data)return!1;o.data.length==0&&(console.log("\u5168\u90E8\u52A0\u8F7D\u5B8C\u6210"),t.value=!0),o.data=o.data.filter(c=>(c.is_delete=!1,c)),e.value=[...e.value,...o.data],console.log(e),i.value=!1}catch(o){console.log(o),u.fire({title:"\u83B7\u53D6\u89C6\u9891\u7A3F\u4EF6\u5931\u8D25",heightAuto:!1,confirmButtonColor:m.colorButtonTheme,icon:"error"})}},re=e=>(Q("data-v-d68a18e6"),e=e(),U(),e),ue={class:"overall"},de={class:"content"},_e=["infinite-scroll-disabled"],fe={class:"article-item"},me=["onClick"],pe={class:"item-right"},ve={class:"data"},he=["onClick"],ge={class:"item-info"},Be={class:"icon-item"},ye={class:"function"},Ae={class:"record-empty"},De={class:"load-more"},Ce=re(()=>n("div",{class:"spread-bottom"},null,-1)),Ee=z({__name:"article",setup(e){S;const{route:i,router:s,articleList:t,isLoading:o,pageInfo:c,loading:B,isLoadMore:p,isTheEnd:r,editArticleStore:b}=ie(),w=d=>{le(t,d)},D=d=>{ne(d,s)},T=d=>{ce(d,B,b,s)},I=async()=>{if(!r.value||(p.value=!0,t.value.length<=0))return!1;console.log("\u52A0\u8F7D"),k(t,o,c,r),p.value=!1};return H(()=>i.path,async()=>{t.value=[],o.value=!0,k(t,o,c,r),console.log(r.value)},{immediate:!0,deep:!0}),(d,Fe)=>{const x=te,R=J,C=N,L=V,M=W,E=G;return g(),h("div",ue,[_(x,{title:"\u4E13\u680F\u7BA1\u7406","icon-nmae":"column",animate:!1,whiteWhale:!1}),f((g(),h("div",de,[f((g(),h("div",{class:"article-list","infinite-scroll-delay":1e3,"infinite-scroll-disabled":a(r),"infinite-scroll-immediate":!1},[(g(!0),h(O,null,P(a(t),(l,Se)=>(g(),h("div",{class:K({animate__animated:!0,animate__fadeOutLeftBig:l.is_delete}),key:l.id,placement:"top"},[n("div",fe,[n("div",{class:"item-left",onClick:y=>D(l)},[_(R,{class:"item-img",src:l.cover,fit:"cover"},null,8,["src"])],8,me),n("div",pe,[n("div",ve,[n("div",{class:"item-title",onClick:y=>D(l)},[_(a(S),{visibleLine:1,text:l.title},null,8,["text"])],8,he),n("div",ge,[n("div",Be," \u9605\u8BFB\u6570\u91CF : "+X(l.heat),1)])]),n("div",ye,[f(_(C,{type:"primary",icon:a(Y),circle:"",onClick:y=>T(l)},null,8,["icon","onClick"]),[[a(F)]]),f(_(C,{type:"info",icon:a(Z),onClick:y=>w(l.id),circle:""},null,8,["icon","onClick"]),[[a(F)]])])])])],2))),128))],8,_e)),[[A,a(t).length>0],[M,I]]),f(n("div",Ae,[_(L,{description:"\u8FD8\u672A\u53D1\u5E03\u4E13\u680F,\u5FEB\u53BB\u53D1\u5E03\u5427~"})],512),[[A,a(t).length==0&&a(o)==!1]]),f(n("div",De,null,512),[[A,a(t).length>0&&a(p)],[E,!0]]),Ce])),[[E,a(o)]])])}}});const qe=ee(Ee,[["__scopeId","data-v-d68a18e6"]]);export{qe as default};
