import{L as B,s as v,S as n,H as _,d as U,o as y,a0 as A,aI as C,U as b,J as S,c as F,b as i,g as l,w as d,u as t,i as D,f as h,C as w,D as x,a as p,aG as I,G as T,l as k}from"./index.0228ac47.js";/* empty css                  *//* empty css                  */import"./aliyun-oss-sdk.c5af02fd.js";/* empty css                */import{_ as M}from"./pageHeader.3132b316.js";import{v as R}from"./focus.de63bc5a.js";import{g as q}from"./commonality.2a0df1e0.js";import{u as G}from"./personal.ec4b42a6.js";import{u as N}from"./upload.8470b696.js";import"./index.f22c08f3.js";const j=()=>{const e=B(),o=v({FileUrl:"",uploadUrl:"",interface:"userAvatar",uploadType:"",action:"#",progress:0});return{userStore:e,uploadAvatarForm:o}},H=e=>({handleFileSuccess:(a,r)=>{e.FileUrl=URL.createObjectURL(r.raw)},beforeFileUpload:a=>a.size/1024/1024>5?(n.fire({title:"\u6587\u4EF6\u4E0D\u7B26\u5408\u683C\u5F0F",heightAuto:!1,icon:"error"}),!1):(console.log(a.text),!0),handleFileError:a=>{console.log("\u4E0A\u4F20\u5931\u8D25"),n.fire({title:"\u4E0A\u4F20\u5931\u8D25",heightAuto:!1,icon:"error"}),console.log(a)},redefineUploadFile:async a=>{try{console.log("uploadAvatarForm\u4E3A",e);const r=await N(e,a.file);e.uploadUrl=r.path,console.log("uploadFile\u65B9\u6CD5\u7684response\u4E3A",r)}catch(r){console.log(r),n.fire({title:"\u83B7\u53D6\u4E0A\u4F20\u8282\u70B9\u5931\u8D25",heightAuto:!1,confirmButtonColor:_.colorButtonTheme,icon:"error"})}}}),L=async e=>{try{const o=(await q({method:e.interface})).data;e.uploadType=o.type,console.log(o)}catch(o){console.log(o),n.fire({title:"\u83B7\u53D6\u4E0A\u4F20\u65B9\u6CD5\u5931\u8D25",heightAuto:!1,confirmButtonColor:_.colorButtonTheme,icon:"error"})}},P=async(e,o)=>{var s;try{if(!o.uploadUrl)throw"\u8BF7\u5148\u4E0A\u4F20\u56FE\u7247";const u={imgUrl:o.uploadUrl,type:o.uploadType};console.log("\u6253\u5370\u66F4\u65B0\u5934\u50CF\u7684\u8BF7\u6C42\u4F53:url:",u.imgUrl,"type:",u.type);const c=await G(u);o.FileUrl="",e.userInfoData.photo=(s=String(c.data))!=null?s:"",console.log("\u7528\u6237\u4FE1\u606F\u7684photo\u5B57\u6BB5\u66F4\u65B0\u4E3A:",c.data),n.fire({title:"\u66F4\u6362\u6210\u529F",heightAuto:!1,icon:"success"}),console.log("\u4E0A\u4F20\u6210\u529F")}catch(u){console.log(u),n.fire({title:"\u8BF7\u4E0A\u4F20\u56FE\u7247",confirmButtonColor:_.colorButtonTheme,heightAuto:!1,icon:"warning"})}},V=e=>(w("data-v-4a052be9"),e=e(),x(),e),z={class:"overall"},J={class:"principal personal-layout animate__animated animate__slideInRight"},O={class:"form-box"},$=["src"],K={class:"avatar-show"},Q={class:"bottom-box"},W=V(()=>l("span",{class:"text"}," \u8BF7\u9009\u62E9\u56FE\u7247\u4E0A\u4F20:\u5927\u5C0F180 * 180\u50CF\u7D20\u652F\u6301JPG\u3001PNG\u7B49\u683C\u5F0F,\u56FE\u7247\u9700\u5C0F\u4E8E2M",-1)),X={class:"button"},Y=U({__name:"pictureSetting",setup(e){const{userStore:o,uploadAvatarForm:s}=j(),u=H(s);return y(()=>{L(s)}),(c,a)=>{const r=M,f=A,m=C,g=b,E=S;return p(),F("div",z,[i(r,{title:"\u66F4\u6362\u5934\u50CF","icon-nmae":"pictures"}),l("div",J,[l("div",O,[i(m,{class:"avatar-uploader",action:t(s).action,"show-file-list":!0,"on-success":t(u).handleFileSuccess,"on-error":t(u).handleFileError,"before-upload":t(u).beforeFileUpload,"auto-upload":!0,"http-request":t(u).redefineUploadFile},{default:d(()=>[t(s).FileUrl?(p(),F("img",{key:0,src:t(s).FileUrl,accept:".png,.jpg,.jpeg",class:"avatar"},null,8,$)):(p(),h(f,{key:1,class:"avatar-uploader-icon"},{default:d(()=>[i(t(I))]),_:1}))]),_:1},8,["action","on-success","on-error","before-upload","http-request"]),l("div",null,[l("div",K,[i(g,{size:240,src:t(o).userInfoData.photo},null,8,["src"])])])]),l("div",Q,[W,l("div",X,[D((p(),h(E,{onClick:a[0]||(a[0]=Z=>t(P)(t(o),t(s))),type:"primary",round:""},{default:d(()=>[T("\u4FEE\u6539\u5934\u50CF ")]),_:1})),[[t(R)]])])])])])}}});const pe=k(Y,[["__scopeId","data-v-4a052be9"]]);export{pe as default};
