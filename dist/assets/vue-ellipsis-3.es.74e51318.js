import{d as T,ak as G,x as J,c as h,u as z,f as S,w as W,r as b,M as d,o as K,O as Q,a as f,g as M,al as q,B as Y,F as Z,G as ee,t as D,q as te,n as ne}from"./index.0228ac47.js";const le=["innerHTML"],ie={key:1,class:"vue-ellipsis-native-text"},se=T({__name:"NativeEllipsis",props:{text:{type:String},visibleLine:{type:Number},ellipsis:{type:Boolean},useInnerHtml:{type:Boolean}},setup(t){const e=t;return(n,i)=>(f(),h("div",{class:te(["vue-ellipsis-native",{ellipsis:e.ellipsis}]),style:ne({webkitLineClamp:e.visibleLine})},[e.useInnerHtml?(f(),h("span",{key:0,innerHTML:e.text,class:"vue-ellipsis-native-html"},null,8,le)):(f(),h("span",ie,D(e.text),1))],6))}}),oe=(t,e)=>{const n=t.__vccOpts||t;for(const[i,r]of e)n[i]=r;return n},re=oe(se,[["__scopeId","data-v-e586cf55"]]);function ae(t){return t instanceof RegExp}function O(t){return typeof t=="string"}const B=typeof window<"u"&&typeof document<"u",ue=B&&typeof document.body.style.webkitLineClamp<"u",I=B&&typeof ResizeObserver<"u";function E(t,e){return window.getComputedStyle||(window.getComputedStyle=function(n){return this.getPropertyValue=function(i){const r=/(-([a-z]){1})/g;return i==="float"&&(i="styleFloat"),r.test(i)&&(i=i.replace(r,function(){return arguments[2].toUpperCase()})),n.currentStyle&&n.currentStyle[i]?n.currentStyle[i]:null},this}),window.getComputedStyle(t,null).getPropertyValue(e)}function ce(t){const e=E(t,"line-height");if(e==="normal"){const n=document.createElement("span");n.style.width="300px",n.style.position="absolute",n.style.visibility="hidden",n.innerText="ruofee",t.appendChild(n);const i=n.clientHeight;return t.removeChild(n),i*1.1}return parseFloat(e)}function pe(t){const e=E(t,"word-break"),n=E(t,"overflow-wrap");if(e!=="word-break"&&e!=="break-all"&&n!=="break-word"){const i=t.style.wordBreak;return t.style.wordBreak="break-word",i}}function F(t,e){t.style.wordBreak=e}function de(t,e){return Math.floor((t+e)/2)}function V(t,e,n,i){for(;t<e;){const r=de(t,e);if(i(t,e,r))break;n(t,e,r)?e=r:t=r}}function fe(t){const e=document.createElement("span");return e.className="vue-ellipsis-js-content-text",e.textContent=t,e}function A(t){var e;!B||(t.nodeType===Node.TEXT_NODE?t.textContent&&((e=t.parentNode)==null||e.replaceChild(fe(t.textContent),t)):t.childNodes.forEach(n=>{A(n)}))}function w(t){return t.clientHeight}function P(){return[]}const ve=T({__name:"JsEllipsis",props:{text:{type:String,required:!0},visibleLine:{type:Number,default:1},visibleHeight:{type:Number},maxLine:{type:Number},maxHeight:{type:Number},ellipsis:{type:Boolean},endExcludes:{type:Array,default:P},useInnerHtml:{type:Boolean},reflowOnResize:{type:Boolean},onReflow:{type:Function},onEllipsisClick:{type:Function}},setup(t){const e=t,n=b(),i=b(),r=b(),g=b(),k=b();d(()=>e.text,u),d(()=>e.ellipsis,u),d(()=>e.useInnerHtml,u),d(()=>e.maxLine,u),d(()=>e.visibleLine,u),d(()=>e.maxHeight,u),d(()=>e.visibleHeight,u),d(()=>e.endExcludes,u);function L(l,s){var a;(a=e==null?void 0:e.onReflow)==null||a.call(e,l,s)}function U(){var l;(l=e==null?void 0:e.onEllipsisClick)==null||l.call(e)}function u(){if(!n.value||!i.value||!r.value||g.value||(r.value.style.display="none",e.useInnerHtml?i.value.innerHTML=e.text:i.value.innerText=e.text,!e.ellipsis))return;const l=ce(n.value),s=pe(i.value),a=typeof e.visibleHeight>"u"?l*e.visibleLine:e.visibleHeight,c=typeof e.maxHeight>"u"?typeof e.maxLine>"u"?a:l*e.maxLine:e.maxHeight;if(w(n.value)<=Math.max(c,a)){L(!1,e.text),O(s)&&F(i.value,s);return}g.value=!0,r.value.style.display="inline",e.useInnerHtml?(A(i.value),C(n.value,i.value,a)):_(n.value,i.value,a),O(s)&&F(i.value,s),g.value=!1}function _(l,s,a){const c=s.textContent||"";let o="";V(0,c.length,(p,m,v)=>{const H=c.slice(p,v);s.innerText=o+H;const y=w(l)>a;return y||(o+=H),y},(p,m,v)=>p===v),o=$(o),s.innerText=o,L(!0,o)}function C(l,s,a){const c=s.childNodes;if(c.length===1){const o=c[0];if(o.nodeType===Node.TEXT_NODE)_(l,s,a);else{const p=o.innerHTML;if(o.innerHTML="",w(l)>a){s.removeChild(o),L(!0,s.innerHTML);return}o.innerHTML=p,C(l,o,a)}}else{const o=[].slice.call(c),p=[];let m=0;V(0,o.length,(v,H,y)=>{s.innerHTML="";const N=o.slice(v,y);p.forEach(x=>{s.appendChild(x)}),N.forEach(x=>{s.appendChild(x)});const R=w(l)>a;return R||N.forEach(x=>{p.push(x)}),R},(v,H,y)=>{if(v===y){const N=w(l)>a;return m=y,N||s.appendChild(o[m]),!0}return!1}),s.childNodes[m]&&C(l,s.childNodes[m],a)}}function X(l){for(const s of e.endExcludes)if(ae(s)){if(s.test(l))return!0}else if(s===l)return!0;return!1}function $(l){for(;!!l.length&&X(l[l.length-1]);)l=l.slice(0,-1);return l}return K(()=>{u(),n.value&&e.reflowOnResize&&(I?(k.value=new ResizeObserver(u),k.value.observe(n.value)):window.addEventListener("resize",u))}),Q(()=>{var l,s;I&&k.value?(s=(l=k.value)==null?void 0:l.disconnect)==null||s.call(l):window.removeEventListener("resize",u)}),(l,s)=>(f(),h("div",{ref_key:"aref",ref:n,class:"vue-ellipsis-js"},[M("span",{ref_key:"textRef",ref:i,class:"vue-ellipsis-js-content"},null,512),M("span",{ref_key:"ellipsisRef",ref:r,class:"vue-ellipsis-js-ellipsis",onClick:U},[q(l.$slots,"ellipsisNode")],512)],512))}}),j="...",ye={class:"vue-ellipsis"},he=T({__name:"index",props:{text:{type:String,required:!0},visibleLine:{type:Number,default:1},visibleHeight:{type:Number},maxLine:{type:Number},maxHeight:{type:Number},ellipsis:{type:Boolean,default:!0},ellipsisNode:{type:String,default:j},endExcludes:{type:Array,default:P},useInnerHtml:{type:Boolean,default:!1},reflowOnResize:{type:Boolean,default:!1},onReflow:{type:Function},onEllipsisClick:{type:Function}},setup(t){const e=t,n=G(),i=J(()=>ue&&(typeof e.maxLine>"u"||e.maxLine===e.visibleLine)&&e.endExcludes.length===0&&e.ellipsisNode===j&&typeof n.ellipsisNode>"u"&&typeof e.maxHeight>"u"&&typeof e.visibleHeight>"u"&&typeof e.onReflow>"u"&&typeof e.onEllipsisClick>"u");return(r,g)=>(f(),h("div",ye,[z(i)?(f(),S(re,{key:0,text:e.text,"visible-line":e.visibleLine,ellipsis:e.ellipsis,"use-inner-html":e.useInnerHtml},null,8,["text","visible-line","ellipsis","use-inner-html"])):(f(),S(ve,{key:1,text:t.text,"use-inner-html":t.useInnerHtml,"visible-line":t.visibleLine,"visible-height":t.visibleHeight,"max-line":t.maxLine,"max-height":t.maxHeight,ellipsis:t.ellipsis,"end-excludes":t.endExcludes,"reflow-on-resize":t.reflowOnResize,"on-reflow":t.onReflow,"on-ellipsis-click":t.onEllipsisClick},{ellipsisNode:W(()=>[z(n).ellipsisNode?Y("",!0):(f(),h(Z,{key:0},[ee(D(t.ellipsisNode),1)],64)),q(r.$slots,"ellipsisNode")]),_:3},8,["text","use-inner-html","visible-line","visible-height","max-line","max-height","ellipsis","end-excludes","reflow-on-resize","on-reflow","on-ellipsis-click"]))]))}});(function(){try{var t=document.createElement("style");t.innerText=`.vue-ellipsis-native.ellipsis[data-v-e586cf55]{display:-webkit-box;overflow:hidden;text-overflow:ellipsis;word-break:break-word;-webkit-box-orient:vertical}
`,document.head.appendChild(t)}catch(e){console.error(e,"unable to concat style inside the bundled file")}})();export{he as y};
